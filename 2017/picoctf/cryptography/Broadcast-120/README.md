### Broadcast - 120 points

> You stumbled upon a group Message. Can you figure out what they were sending? The string sent is ascii encoded as a hex number (submit the ascii string as the flag)

Hint:
> The same message, with a small exponent, is being encrypted with several different n values


This was another known attack against the RSA cryptosystem called [HÃ¥stad's broadcast attack](https://en.wikipedia.org/wiki/Coppersmith%27s_attack#H.C3.A5stad.27s_broadcast_attack), and it was easy to figure it out. The group message that is given has the following content:
```
e = 3 
c1 = 261345950255088824199206969589297492768083568554363001807292202086148198406422015406837306712350185001004539557263392747990052517553733793783164539246862722846027251864430884218012651143187891041767278036834613455255679627575565220404720823343734717216496823882624775291829042065791328110144692179931720656184
n1 = 1001191535967882284769094654562963158339094991366537360172618359025855097846977704928598237040115495676223744383629803332394884046043603063054821999994629411352862317941517957323746992871914047324555019615398720677218748535278252779545622933662625193622517947605928420931496443792865516592262228294965047903627
c2 = 147535246350781145803699087910221608128508531245679654307942476916759248177533099119747011361428805549054451656981174660189536226806378907786889467354024644240879320253207532952949102143188764785409228498939338911381114763011074430123706304767125057179745262429033988355639559021251950099792930724833562784673
n2 = 405864605704280029572517043538873770190562953923346989456102827133294619540434679181357855400199671537151039095796094162418263148474324455458511633891792967156338297585653540910958574924436510557629146762715107527852413979916669819333765187674010542434580990241759130158992365304284892615408513239024879592309 
c3 = 633230627388596886579908367739501184580838393691617645602928172655297372011548865034935604403952733958738640693591337661775300212965321256493515985362225064130164637923136989033908516462412694733923594235845265750167194852656423103420952926986457914303614556562367709542082728589329045460298763797973333272805
n3 = 1204664380009414697639782865058772653140636684336678901863196025928054706723976869222235722439176825580211657044153004521482757717615318907205106770256270292154250168657084197056536811063984234635803887040926920542363612936352393496049379544437329226857538524494283148837536712608224655107228808472106636903723
```
The attack works as follows, if the same message ```m``` is ciphered by multiple people each with different values of ```n``` and same small public exponent ```e``` then, we can retrieve the original message since it is no longer secure. All we have to do is take each ciphertext and each modulo and solve the Chinese Theorem Remainder to obtain the cube of the original message. 

Finally, we just need to compute the cube root of the value returned by the CRT and we obtain the original message.
```python
if __name__ == '__main__':

    ciphertexts = [c1, c2, c3]

    modulus = [n1, n2, n3]

    C = chinese_remainder_theorem([(c1, n1), (c2, n2), (c3, n3)])
    M = int(root(C, 3))

    print(codecs.decode(hex(M).replace("0x", "").replace("L", ""), "hex"))    
```

Decoding the value we get the flag:
```
broadcast_with_small_e_is_killer_16126509732
```
